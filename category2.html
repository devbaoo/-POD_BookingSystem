<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">

    <title>BD.com - Buiding</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">


    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-plot-listing.css">
    <link rel="stylesheet" href="assets/css/animated.css">
    <link rel="stylesheet" href="assets/css/owl.css">
    <link rel="stylesheet" href="assets/css/result.css">
    <link rel="stylesheet" href="assets/css/index.css">

</head>

<body>

    <!-- ***** Preloader Start ***** -->
    <div id="js-preloader" class="js-preloader">
        <div class="preloader-inner">
            <span class="dot"></span>
            <div class="dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </div>
    <!-- ***** Preloader End ***** -->

    <!-- ***** Header Area Start ***** -->

    <header class="header-area header-sticky wow slideInDown" data-wow-duration="0.75s" data-wow-delay="0s">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <nav class="main-nav">
                        <!-- ***** Logo Start ***** -->
                        <a href="index.html" class="logo">
                        </a>
                        <!-- ***** Logo End ***** -->
                        <!-- ***** Menu Start ***** -->
                        <ul class="nav">
                            <li><a href="index.html">Home</a></li>
                            <li><a href="category2.html" class="active">Category</a></li>
                            <li><a href="listing.html">Listing</a></li>
                            <li><a href="contact.html">Contact Us</a></li>
                            <ul>
                                <li id="loginButtonContainer">
                                    <div class="main-white-button">
                                        <a href="login.html"><i class="fa fa-plus"></i> Log in</a>
                                    </div>
                                </li>
                                <li id="usernameContainer" style="display: none;">
                                    <div class="nav-right-side">
                                        <button class="mode-switch">
                                            <svg class="sun" fill="none" stroke="#fbb046" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" class="feather feather-sun"
                                                viewBox="0 0 24 24">
                                                <defs />
                                                <circle cx="12" cy="12" r="5" />
                                                <path
                                                    d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" />
                                            </svg>
                                            <svg class="moon" fill="none" stroke="#ffffff" stroke-linecap="round"
                                                stroke-linejoin="round" stroke-width="2" class="feather feather-moon"
                                                viewBox="0 0 24 24">
                                                <defs />
                                                <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
                                            </svg>
                                        </button>
                                        <button class="profile-btn" id="profileButton">
                                            <span id="loggedInUsername"></span>
                                            <img src="https://images.unsplash.com/photo-1492633397843-92adffad3d1c?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=2167&q=80"
                                                alt="profile picture">
                                        </button>
                                    </div>
                                </li>
                            </ul>
                        </ul>
                        <a class='menu-trigger'>
                            <span>Menu</span>
                        </a>
                        <!-- ***** Menu End ***** -->
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <!-- ***** Header Area End ***** -->

    <script>
        document.getElementById('profileButton').addEventListener('click', function () {
            window.location.href = 'profile.html';
        });
    </script>

<script src="https://cdn.jsdelivr.net/npm/jwt-decode@3.1.2/build/jwt-decode.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Lấy authToken từ localStorage
        const authToken = localStorage.getItem('authToken');
        let username = null;

        if (authToken) {
            // Giải mã JWT để lấy username
            try {
                const decoded = jwt_decode(authToken);  // Giải mã JWT
                console.log("Decoded JWT:", decoded);  // Kiểm tra JWT đã giải mã

                // Lấy username từ thông tin trong JWT
                username = decoded.sub;  // 'sub' là thông thường là user ID hoặc username
            } catch (error) {
                console.error('Lỗi khi giải mã token:', error);
            }
        }

        // Nếu không có username trong token, lấy từ localStorage
        if (!username) {
            username = localStorage.getItem('username');
        }

        console.log("Username từ localStorage hoặc JWT:", username); // Kiểm tra username

        const loginButtonContainer = document.getElementById('loginButtonContainer');
        const usernameContainer = document.getElementById('usernameContainer');
        const loggedInUsername = document.getElementById('loggedInUsername');

        if (username) {
            // Nếu có username, hiển thị và ẩn phần tử login
            loggedInUsername.textContent = `Chào mừng, ${username}`;
            loginButtonContainer.style.display = 'none';
            usernameContainer.style.display = 'block';
        } else {
            // Nếu không có username, hiển thị nút login và ẩn phần tử username
            loginButtonContainer.style.display = 'block';
            usernameContainer.style.display = 'none';
        }
    });
</script>

    <div class="page-heading">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <div class="top-text header-text">
                        <h6>Your building your choice</h6>
                        <h2>We have a wide range of business categories for you</h2>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="category-post">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="naccs">
                        <div class="grid">
                            <div class="row">


                                <div class="results-container">
                                    <h2>Available Buildings</h2>
                                    <div id="results"></div>
                                </div>


                                <script type="module">
                                    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
                                    import { getStorage, ref, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-storage.js";

                                    const firebaseConfig = {
                                        apiKey: "AIzaSyBb4O_rxVQu5590kRl46VQhx9EzIcY0_WA",
                                        authDomain: "pod-booking-system-437803.firebaseapp.com",
                                        projectId: "pod-booking-system-437803",
                                        storageBucket: "pod-booking-system-437803.appspot.com",
                                        messagingSenderId: "627345452977",
                                        appId: "1:627345452977:web:6a6ff675728bcdd5161790",
                                        measurementId: "G-8Y8FVDJY6K"
                                    };

                                    const app = initializeApp(firebaseConfig);
                                    const storage = getStorage(app);
                                    const resultsContainer = document.getElementById('results');

                                    document.addEventListener('DOMContentLoaded', function () {
                                        displayBuildings(); // Call the displayBuildings function here
                                    });

                                    function displayBuildings() {
                                        let storedBuildings = JSON.parse(localStorage.getItem('allBuildings'));

                                        if (storedBuildings && storedBuildings.length > 0 && resultsContainer) {
                                            storedBuildings.forEach(building => {
                                                const buildingElement = document.createElement('div');
                                                buildingElement.className = 'building';

                                                if (building.imageName) {
                                                    const storageRef = ref(storage, `buildings/${building.imageName}`);
                                                    getDownloadURL(storageRef).then(url => {
                                                        createBuildingElement(buildingElement, building, url);
                                                    }).catch((error) => {
                                                        console.error(`Error getting image for ${building.name}:`, error);
                                                        createBuildingElementWithoutImage(buildingElement, building);
                                                    });
                                                } else {
                                                    console.warn(`No image name provided for building: ${building.name}`);
                                                    createBuildingElementWithoutImage(buildingElement, building);
                                                }
                                            });
                                        } else {
                                            if (resultsContainer) {
                                                resultsContainer.innerHTML = '<p class="no-buildings">Không tìm thấy tòa nhà nào.</p>';
                                            }
                                        }
                                    }

                                    function createBuildingElement(buildingElement, building, imageUrl) {
                                        buildingElement.innerHTML = `<img src="${imageUrl}" alt="${building.name}">
        <div class="content">
            <h3>${building.name}</h3>
            <p><strong>Building-Id:</strong> ${building.building_id}</p>
            <p><strong>Address:</strong> ${building.address}</p>
            <p><strong>Location:</strong> ${building.location}</p>
            <p><strong>Description:</strong> ${building.description}</p>
        </div>
    `;
                                        resultsContainer.appendChild(buildingElement);
                                        buildingElement.addEventListener('click', () => {
                                            window.location.href = `listing.html?building_id=${building.building_id}`;
                                        });
                                    }

                                    function createBuildingElementWithoutImage(buildingElement, building) {
                                        let imageUrl = "assets/images/default-image.jpg";

                                        if (building.name === "Adventure") {
                                            imageUrl = "assets/images/default-image.jpg";
                                        } else if (building.name === "RESK") {
                                            imageUrl = "assets/images/Landmark.jpg";
                                        } else if (building.name === "MOMAN") {
                                            imageUrl = "assets/images/Lotte.jpg";
                                        } else if (building.name === "KLARA") {
                                            imageUrl = "assets/images/bitexco.jpg";
                                        } else if (building.name === "Keangnam Landmark Tower") {
                                            imageUrl = "assets/images/1.jpg";
                                        }

                                        buildingElement.innerHTML = `
        <img src="${imageUrl}" alt="${building.name}">
        <div class="content">
            <h3>${building.name}</h3>
            <p><strong>Building-Id:</strong> ${building.building_id}</p>
            <p><strong>Address:</strong> ${building.address}</p>
            <p><strong>Location:</strong> ${building.location}</p>
            <p><strong>Description:</strong> ${building.description}</p>
        </div>
    `;

                                        resultsContainer.appendChild(buildingElement);

                                        buildingElement.addEventListener('click', () => {
                                            window.location.href = `listing.html?building_id=${building.building_id}`;
                                        });
                                    }
                                </script>

                                <div class="col-lg-12">
                                    <ul class="nacc">
                                        <li class="active">
                                            <div>
                                                <div class="thumb">
                                                    <div class="row">
                                                        <div class="col-lg-12">
                                                            <div class="top-content">
                                                                <div class="row">
                                                                    <div class="col-lg-6">
                                                                        <div class="top-icon">
                                                                            <span class="icon"><img
                                                                                    src="assets/images/search-icon-01.png"
                                                                                    alt="">
                                                                                <h4>Apartments</h4>
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-6">
                                                                        <div class="main-white-button">
                                                                            <a href="#"><i class="fa fa-plus"></i> Check
                                                                                Our Listings</a>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-12">
                                                            <div class="description">
                                                                <div class="row">
                                                                    <div class="col-lg-9">
                                                                        <h4>Description for Apartments</h4>
                                                                        <p>If you feel that Plot Listing HTML template
                                                                            is useful, please <a rel="nofollow"
                                                                                href="https://www.paypal.me/templatemo"
                                                                                target="_blank">support us</a> a little
                                                                            via PayPal. You are allowed to use this
                                                                            template for your commercial websites. You
                                                                            are NOT allowed to redistribute this
                                                                            template ZIP file on any Free CSS collection
                                                                            websites. You may contact us for more
                                                                            information. Thank you.</p>
                                                                    </div>
                                                                    <div class="col-lg-3">
                                                                        <div class="text-icon">
                                                                            <h4><img src="assets/images/listing-icon-heading.png"
                                                                                    alt=""> Total Listings</h4>
                                                                        </div>
                                                                        <span class="list-item">This Week: 200 Listings
                                                                            &amp; 150 Sales<br>This Month: 1,800
                                                                            Listings &amp; 1,560 Sales<br>This Year:
                                                                            16,000 Listings &amp; 14,000 Sales</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-12">
                                                            <div class="general-info">
                                                                <div class="row">
                                                                    <div class="col-lg-12">
                                                                        <h4>General Info. about Apartments</h4>
                                                                        <p>Lorem ipsum dolor sit amet, consectetur
                                                                            adipiscing elit, sed do eiusmod tempor ak
                                                                            incididunt ut labore et dolore magna aliqua.
                                                                            Quis ipsum suspendisse ultrices
                                                                            gravidat doerski. Sed ut perspiciatis unde
                                                                            omnis iste natus error sit voluptatem
                                                                            accusantium doloremque.</p>
                                                                        <span class="list-item">* Listing should have
                                                                            all the proper documents before being
                                                                            checked in.
                                                                            <br>** Listing will be checked by our team
                                                                            members.
                                                                            <br>*** After being sold, it should
                                                                            imediately be removed from our site and
                                                                            properly monitored.</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-4">
                    <div class="about">
                        <div class="logo">
                            <img src="assets/images/logoBD.jpg" alt="">
                        </div>
                        <p>Lorem ipsum dolor sit amet, consectetur adicingi elit, sed do eiusmod tempor incididunt ut et
                            dolore
                            magna aliqua.</p>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="helpful-links">
                        <h4>Helpful Links</h4>
                        <div class="row">
                            <div class="col-lg-6">
                                <ul>
                                    <li><a href="#">Categories</a></li>
                                    <li><a href="#">Reviews</a></li>
                                    <li><a href="#">Listing</a></li>
                                    <li><a href="#">Contact Us</a></li>
                                </ul>
                            </div>
                            <div class="col-lg-6">
                                <ul>
                                    <li><a href="#">About Us</a></li>
                                    <li><a href="#">Awards</a></li>
                                    <li><a href="#">Useful Sites</a></li>
                                    <li><a href="#">Privacy Policy</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="contact-us">
                        <h4>Contact Us</h4>
                        <p>27th Street of New Town, Digital Villa</p>
                        <div class="row">
                            <div class="col-lg-6">
                                <a href="#">010-020-0340</a>
                            </div>
                            <div class="col-lg-6">
                                <a href="#">090-080-0760</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                </div>
            </div>
        </div>
    </footer>


    <!-- Scripts -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/owl-carousel.js"></script>
    <script src="assets/js/animation.js"></script>
    <script src="assets/js/imagesloaded.js"></script>
    <script src="assets/js/custom.js"></script>

</body>

</html>